# XHS Analyzer - 測試用例

## 📋 測試計劃

### 測試環境
- 瀏覽器: Chrome/Firefox/Safari (最新版本)
- 操作系統: Windows/macOS/Linux
- 網絡: 穩定的互聯網連接

---

## 1. 分析功能測試

### TC-001: 基本分析流程
**目的**: 驗證基本的帖子分析功能

**步驟**:
1. 訪問 `/analyze` 頁面
2. 輸入有效的小紅書鏈接
3. 點擊「開始分析」按鈕
4. 等待分析完成

**預期結果**:
- ✅ 頁面加載成功
- ✅ 輸入框可編輯
- ✅ 按鈕可點擊
- ✅ 分析結果在 2 秒內返回
- ✅ 顯示完整的分析數據
- ✅ 自動保存到歷史記錄

**測試數據**:
```
URL: https://www.xiaohongshu.com/discovery/item/696dd8150000000021031a64
```

---

### TC-002: 無效 URL 處理
**目的**: 驗證無效 URL 的錯誤處理

**步驟**:
1. 訪問 `/analyze` 頁面
2. 輸入無效的 URL（不包含 xiaohongshu.com）
3. 點擊「開始分析」按鈕

**預期結果**:
- ✅ 顯示錯誤提示：「請提供有效的小紅書鏈接」
- ✅ 不發送 API 請求
- ✅ 輸入框保持可編輯

**測試數據**:
```
URL: https://www.google.com
URL: invalid-url
URL: (空)
```

---

### TC-003: 分析結果展示
**目的**: 驗證分析結果的完整性和正確性

**步驟**:
1. 完成 TC-001
2. 檢查所有展示的數據

**預期結果**:
- ✅ 標題和作者正確顯示
- ✅ 點贊、評論、分享數字正確
- ✅ 互動率計算正確
- ✅ 熱度評分在 0-100 之間
- ✅ 情感傾向為 positive/neutral/negative 之一
- ✅ 關鍵詞列表非空
- ✅ 變現潛力為 high/medium/low 之一
- ✅ 優化建議至少有一條

---

### TC-004: 連續分析
**目的**: 驗證多次分析的穩定性

**步驟**:
1. 訪問 `/analyze` 頁面
2. 分析第一個帖子
3. 清空輸入框
4. 分析第二個帖子
5. 重複 3-4 次

**預期結果**:
- ✅ 每次分析都成功完成
- ✅ 結果正確更新
- ✅ 沒有內存洩漏
- ✅ 頁面保持響應

---

## 2. 歷史記錄測試

### TC-005: 保存到歷史記錄
**目的**: 驗證分析結果自動保存

**步驟**:
1. 完成 TC-001
2. 訪問 `/history` 頁面
3. 檢查最新的記錄

**預期結果**:
- ✅ 新分析出現在歷史記錄頂部
- ✅ 記錄包含完整的分析數據
- ✅ 時間戳正確

---

### TC-006: 歷史記錄篩選
**目的**: 驗證篩選功能

**步驟**:
1. 訪問 `/history` 頁面
2. 選擇「高潛力」篩選
3. 檢查顯示的記錄
4. 選擇「中等潛力」
5. 選擇「低潛力」
6. 選擇「全部」

**預期結果**:
- ✅ 每次篩選都正確更新列表
- ✅ 只顯示符合條件的記錄
- ✅ 記錄數量正確

---

### TC-007: 歷史記錄排序
**目的**: 驗證排序功能

**步驟**:
1. 訪問 `/history` 頁面
2. 選擇「最新優先」排序
3. 檢查順序
4. 選擇「熱度最高」
5. 檢查順序
6. 選擇「互動最高」
7. 檢查順序

**預期結果**:
- ✅ 每次排序都正確更新列表
- ✅ 排序順序符合預期
- ✅ 記錄數量不變

---

### TC-008: 刪除單條記錄
**目的**: 驗證刪除功能

**步驟**:
1. 訪問 `/history` 頁面
2. 記錄初始記錄數
3. 點擊某條記錄的「刪除」按鈕
4. 確認刪除
5. 檢查記錄數

**預期結果**:
- ✅ 彈出確認對話框
- ✅ 確認後記錄被刪除
- ✅ 記錄數減少 1
- ✅ 其他記錄保持不變

---

### TC-009: 清空所有記錄
**目的**: 驗證批量刪除功能

**步驟**:
1. 訪問 `/history` 頁面
2. 確保有多條記錄
3. 點擊「清空所有記錄」按鈕
4. 確認清空

**預期結果**:
- ✅ 彈出確認對話框
- ✅ 確認後所有記錄被刪除
- ✅ 顯示「暫無分析記錄」提示
- ✅ 導出按鈕禁用

---

## 3. 數據導出測試

### TC-010: 導出 JSON 格式
**目的**: 驗證 JSON 導出功能

**步驟**:
1. 訪問 `/history` 頁面
2. 確保有分析記錄
3. 點擊「導出 JSON」按鈕
4. 檢查下載的文件

**預期結果**:
- ✅ 文件下載成功
- ✅ 文件名格式: `xhs-analysis-{timestamp}.json`
- ✅ 文件內容是有效的 JSON
- ✅ 包含所有分析記錄
- ✅ 包含 exportDate 和 totalRecords

**驗證 JSON 結構**:
```bash
# 檢查文件是否有效
cat xhs-analysis-*.json | jq .
```

---

### TC-011: 導出 CSV 格式
**目的**: 驗證 CSV 導出功能

**步驟**:
1. 訪問 `/history` 頁面
2. 確保有分析記錄
3. 點擊「導出 CSV」按鈕
4. 檢查下載的文件

**預期結果**:
- ✅ 文件下載成功
- ✅ 文件名格式: `xhs-analysis-{timestamp}.csv`
- ✅ 文件可在 Excel 中打開
- ✅ 包含所有列標題
- ✅ 數據正確對齊

**驗證 CSV 結構**:
```bash
# 檢查第一行（標題）
head -1 xhs-analysis-*.csv
```

---

### TC-012: 導出空記錄
**目的**: 驗證空記錄導出的處理

**步驟**:
1. 訪問 `/history` 頁面
2. 清空所有記錄
3. 嘗試點擊「導出 JSON」

**預期結果**:
- ✅ 導出按鈕禁用或提示無數據
- ✅ 不生成空文件

---

## 4. 統計分析測試

### TC-013: 統計頁面加載
**目的**: 驗證統計頁面的加載

**步驟**:
1. 訪問 `/stats` 頁面
2. 等待頁面加載

**預期結果**:
- ✅ 頁面加載成功
- ✅ 顯示統計指標
- ✅ 沒有 JavaScript 錯誤

---

### TC-014: 統計指標計算
**目的**: 驗證統計指標的正確性

**步驟**:
1. 完成多個分析（至少 5 個）
2. 訪問 `/stats` 頁面
3. 檢查各項指標

**預期結果**:
- ✅ 總分析數正確
- ✅ 平均互動率計算正確
- ✅ 平均熱度計算正確
- ✅ 正面情感率計算正確
- ✅ 高潛力帖子比例計算正確

**驗證計算**:
```
平均互動率 = 所有互動率之和 / 分析數
平均熱度 = 所有熱度評分之和 / 分析數
正面情感率 = 正面帖子數 / 總分析數 × 100%
```

---

### TC-015: 熱度分布
**目的**: 驗證熱度分布的正確性

**步驟**:
1. 訪問 `/stats` 頁面
2. 檢查熱度分布

**預期結果**:
- ✅ 病毒級 (>70) 數量正確
- ✅ 高熱度 (50-70) 數量正確
- ✅ 中等 (30-50) 數量正確
- ✅ 低熱度 (≤30) 數量正確
- ✅ 總數 = 分析總數

---

### TC-016: 分類統計
**目的**: 驗證分類統計的正確性

**步驟**:
1. 完成多個不同分類的分析
2. 訪問 `/stats` 頁面
3. 檢查分類統計

**預期結果**:
- ✅ 所有分類都列出
- ✅ 每個分類的帖子數正確
- ✅ 平均熱度計算正確
- ✅ 平均互動率計算正確

---

### TC-017: 洞察生成
**目的**: 驗證智能洞察的生成

**步驟**:
1. 訪問 `/stats` 頁面
2. 檢查「洞察與建議」部分

**預期結果**:
- ✅ 至少顯示 3 條洞察
- ✅ 洞察內容相關且有用
- ✅ 洞察基於實際數據

---

## 5. UI/UX 測試

### TC-018: 響應式設計
**目的**: 驗證在不同屏幕尺寸上的表現

**步驟**:
1. 在桌面瀏覽器上訪問所有頁面
2. 使用開發者工具調整到平板尺寸
3. 調整到手機尺寸
4. 檢查佈局和功能

**預期結果**:
- ✅ 桌面版本正常顯示
- ✅ 平板版本佈局合理
- ✅ 手機版本可用
- ✅ 所有功能都可訪問
- ✅ 文本可讀

---

### TC-019: 導航測試
**目的**: 驗證頁面導航

**步驟**:
1. 訪問首頁
2. 點擊「分析」鏈接
3. 點擊「查看歷史」
4. 點擊「統計分析」
5. 點擊「返回下載」

**預期結果**:
- ✅ 所有鏈接都有效
- ✅ 頁面正確加載
- ✅ 沒有 404 錯誤

---

### TC-020: 加載狀態
**目的**: 驗證加載狀態的顯示

**步驟**:
1. 訪問 `/analyze` 頁面
2. 輸入 URL 並點擊分析
3. 觀察加載狀態

**預期結果**:
- ✅ 按鈕顯示「分析中...」
- ✅ 按鈕禁用
- ✅ 輸入框禁用
- ✅ 分析完成後恢復正常

---

## 6. 性能測試

### TC-021: 頁面加載時間
**目的**: 驗證頁面加載性能

**步驟**:
1. 打開開發者工具的 Network 標籤
2. 訪問各個頁面
3. 記錄加載時間

**預期結果**:
- ✅ 首頁加載時間 < 2 秒
- ✅ 分析頁面加載時間 < 2 秒
- ✅ 歷史頁面加載時間 < 2 秒
- ✅ 統計頁面加載時間 < 2 秒

---

### TC-022: 分析響應時間
**目的**: 驗證分析 API 的響應時間

**步驟**:
1. 打開開發者工具的 Network 標籤
2. 執行分析
3. 記錄 API 響應時間

**預期結果**:
- ✅ API 響應時間 < 1 秒
- ✅ 沒有超時

---

### TC-023: 內存使用
**目的**: 驗證內存使用情況

**步驟**:
1. 打開開發者工具的 Memory 標籤
2. 執行 10 次分析
3. 檢查內存使用

**預期結果**:
- ✅ 內存使用穩定
- ✅ 沒有內存洩漏
- ✅ 內存使用 < 100MB

---

## 7. 瀏覽器兼容性測試

### TC-024: Chrome 兼容性
**目的**: 驗證在 Chrome 中的兼容性

**步驟**:
1. 在最新版 Chrome 中訪問應用
2. 執行所有主要功能

**預期結果**:
- ✅ 所有功能正常工作
- ✅ 沒有控制台錯誤

---

### TC-025: Firefox 兼容性
**目的**: 驗證在 Firefox 中的兼容性

**步驟**:
1. 在最新版 Firefox 中訪問應用
2. 執行所有主要功能

**預期結果**:
- ✅ 所有功能正常工作
- ✅ 沒有控制台錯誤

---

### TC-026: Safari 兼容性
**目的**: 驗證在 Safari 中的兼容性

**步驟**:
1. 在最新版 Safari 中訪問應用
2. 執行所有主要功能

**預期結果**:
- ✅ 所有功能正常工作
- ✅ 沒有控制台錯誤

---

## 8. 數據持久化測試

### TC-027: localStorage 持久化
**目的**: 驗證數據在 localStorage 中的持久化

**步驟**:
1. 完成一個分析
2. 刷新頁面
3. 訪問 `/history` 頁面
4. 檢查記錄是否存在

**預期結果**:
- ✅ 刷新後記錄仍然存在
- ✅ 數據完整

---

### TC-028: 瀏覽器關閉後的持久化
**目的**: 驗證瀏覽器關閉後的數據持久化

**步驟**:
1. 完成一個分析
2. 完全關閉瀏覽器
3. 重新打開瀏覽器
4. 訪問應用
5. 檢查記錄是否存在

**預期結果**:
- ✅ 記錄仍然存在
- ✅ 數據完整

---

## 9. 安全性測試

### TC-029: XSS 防護
**目的**: 驗證 XSS 攻擊防護

**步驟**:
1. 在分析輸入框中輸入 XSS 載荷
2. 嘗試執行分析

**測試數據**:
```
<script>alert('XSS')</script>
javascript:alert('XSS')
```

**預期結果**:
- ✅ 沒有執行 JavaScript
- ✅ 顯示錯誤提示

---

### TC-030: URL 驗證
**目的**: 驗證 URL 驗證機制

**步驟**:
1. 輸入各種 URL
2. 檢查驗證結果

**測試數據**:
```
https://www.xiaohongshu.com/discovery/item/123
http://xiaohongshu.com/feed/456
https://xiaohongshu.com/explore/789
invalid-url
```

**預期結果**:
- ✅ 有效的小紅書 URL 通過驗證
- ✅ 無效的 URL 被拒絕

---

## 測試執行報告模板

```markdown
# 測試執行報告

**測試日期**: YYYY-MM-DD
**測試人員**: [名稱]
**測試環境**: [瀏覽器/OS]

## 測試結果摘要

| 測試用例 | 狀態 | 備註 |
|---------|------|------|
| TC-001  | ✅ PASS | - |
| TC-002  | ✅ PASS | - |
| ...     | ...  | ... |

## 缺陷報告

| 缺陷 ID | 嚴重性 | 描述 | 狀態 |
|---------|--------|------|------|
| BUG-001 | High   | ... | Open |

## 總體評估

- 通過率: XX%
- 建議: ...
```

---

## 自動化測試腳本

### 使用 Playwright 進行自動化測試

```typescript
// tests/analyze.spec.ts
import { test, expect } from '@playwright/test';

test('should analyze a post successfully', async ({ page }) => {
  await page.goto('http://localhost:3000/analyze');
  
  // 輸入 URL
  await page.fill('input[placeholder*="粘貼"]', 'https://www.xiaohongshu.com/discovery/item/123');
  
  // 點擊分析按鈕
  await page.click('button:has-text("開始分析")');
  
  // 等待結果
  await page.waitForSelector('text=分析結果已保存到歷史記錄');
  
  // 驗證結果
  expect(await page.isVisible('text=分享我的日常護膚秘訣')).toBeTruthy();
});
```

---

## 測試覆蓋率目標

- **功能覆蓋率**: 100%
- **代碼覆蓋率**: > 80%
- **分支覆蓋率**: > 75%

---

**版本**: 1.0.0  
**最後更新**: 2024-02-19
